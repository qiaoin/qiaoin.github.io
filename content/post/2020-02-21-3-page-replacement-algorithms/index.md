---
title: é¡µé¢ç½®æ¢ç®—æ³•
author: qiaoin
date: '2020-02-21'
slug: 3-page-replacement-algorithms
categories:
  - æ“ä½œç³»ç»Ÿ
tags: []
---

> é‡å­¦æ“ä½œç³»ç»Ÿç³»åˆ—ï¼Œæ¸…åå¤§å­¦æ“ä½œç³»ç»Ÿè¯¾ç¨‹ç¬”è®°

---

{{< toc >}}

---

## é¡µé¢ç½®æ¢ç®—æ³•çš„æ¦‚å¿µ

**åŠŸèƒ½ï¼š**

å½“å‡ºç°ç¼ºé¡µå¼‚å¸¸ï¼Œéœ€è°ƒå…¥æ–°é¡µé¢è€Œç‰©ç†å†…å­˜å·²æ»¡æ—¶ï¼Œç½®æ¢ç®—æ³•é€‰æ‹©è¢«ç½®æ¢çš„ç‰©ç†é¡µå¸§

**è®¾è®¡ç›®æ ‡ï¼š**

å°½å¯èƒ½å‡å°‘é¡µå¸§çš„è°ƒå…¥è°ƒå‡ºæ¬¡æ•°ï¼ŒæŠŠæœªæ¥ä¸å†è®¿é—®æˆ–çŸ­æœŸå†…ä¸è®¿é—®çš„é¡µå¸§è°ƒå‡ºã€‚è¿™ä¸å®é™…è¿è¡Œçš„ç¨‹åºå¯¹å­˜å‚¨çš„è®¿é—®ç‰¹å¾æœ‰å¾ˆå¤§å…³ç³»ï¼ˆé€šç”¨ç½®æ¢ç®—æ³•è€ƒè™‘å¯èƒ½å¾—è¿›ç¨‹è®¿é—®å­˜å‚¨çš„ç‰¹å¾ï¼‰ã€‚å¦‚ä½•å¯¹æœªæ¥çš„æƒ…å†µè¿›è¡Œä¼°è®¡å‘¢ï¼Ÿ

æœ‰ä¸€äº›ç‰©ç†é¡µå¸§è¢«é”å®šï¼ˆFrame Lockingï¼Œpin memoryï¼‰ï¼Œä¸èƒ½å¤Ÿä»ç‰©ç†å†…å­˜ä¸­æ¢å‡ºåˆ°å¤–å­˜ä¸­å»

- æè¿°å¿…é¡»å¸¸é©»å†…å­˜çš„é€»è¾‘é¡µé¢
- æ“ä½œç³»ç»Ÿçš„å…³é”®éƒ¨åˆ†
- è¦æ±‚å“åº”é€Ÿåº¦çš„ä»£ç å’Œæ•°æ®
- é¡µè¡¨é¡¹ä¸­çš„é”å®šæ ‡å¿—ä½ï¼ˆlock bitï¼‰

**ç½®æ¢ç®—æ³•çš„è¯„ä»·æ–¹æ³•ï¼š**

è®°å½•è¿›ç¨‹è®¿é—®å†…å­˜çš„é¡µé¢è½¨è¿¹ï¼Œæ¨¡æ‹Ÿé¡µé¢ç½®æ¢è¡Œä¸ºï¼Œè®°å½•äº§ç”Ÿç¼ºé¡µçš„æ¬¡æ•°ã€‚æ›´å°‘çš„ç¼ºé¡µï¼Œå¯¹åº”æ›´å¥½çš„æ€§èƒ½

**é¡µé¢ç½®æ¢ç®—æ³•çš„åˆ†ç±»ï¼š**

1. å±€éƒ¨é¡µé¢ç½®æ¢ç®—æ³•ï¼šç½®æ¢é¡µé¢çš„é€‰æ‹©èŒƒå›´ä»…é™äºå½“å‰è¿›ç¨‹å ç”¨çš„ç‰©ç†é¡µé¢å†…
    - æœ€ä¼˜ç®—æ³•ã€å…ˆè¿›å…ˆå‡ºç®—æ³•ã€æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•
    - æ—¶é’Ÿç®—æ³•ã€æœ€ä¸å¸¸ç”¨ç®—æ³•ï¼ˆä¸¤ç§å¯¹æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•çš„è¿‘ä¼¼ï¼‰
2. å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•ï¼šç½®æ¢é¡µé¢çš„é€‰æ‹©èŒƒå›´æ˜¯æ‰€æœ‰å¯æ¢å‡ºçš„ç‰©ç†é¡µé¢
    - å·¥ä½œé›†ç®—æ³•ã€ç¼ºé¡µç‡ç®—æ³•

## å±€éƒ¨ç½®æ¢ç®—æ³•

å‡å®šç»™ä¸€ä¸ªè¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°å·²ç»ç¡®å®šå¥½äº†

### æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆOPTï¼Œoptimalï¼‰

- æ€è·¯ï¼šç½®æ¢åœ¨æœªæ¥æœ€é•¿æ—¶é—´ä¸è®¿é—®çš„é¡µé¢
- å®ç°ï¼šç¼ºé¡µæ—¶ï¼Œè®¡ç®—å†…å­˜ä¸­æ¯ä¸ªé€»è¾‘é¡µé¢çš„ä¸‹ä¸€æ¬¡è®¿é—®æ—¶é—´ï¼Œé€‰æ‹©æœªæ¥æœ€é•¿æ—¶é—´ä¸æ”¾é—®çš„é¡µé¢
- ç‰¹å¾
  - ç¼ºé¡µæœ€å°‘ï¼Œæ˜¯ç†æƒ³æƒ…å†µ
  - å®é™…ç³»ç»Ÿä¸­æ— æ³•å®ç°
  - æ— æ³•é¢„çŸ¥æ¯ä¸ªé¡µé¢åœ¨ä¸‹æ¬¡è®¿é—®å‰çš„ç­‰å¾…æ—¶é—´
  - å¯ä»¥ä½œä¸ºå…¶ä»–ç½®æ¢ç®—æ³•çš„æ€§èƒ½è¯„ä»·ä¾æ®ï¼šåœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡ŒæŸä¸ªç¨‹åºå¹¶è®°å½•æ¯ä¸€æ¬¡çš„é¡µé¢è®¿é—®æƒ…å†µï¼›åœ¨ç¬¬äºŒæ¬¡è¿è¡Œæ—¶ä½¿ç”¨æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•

### å…ˆè¿›å…ˆå‡ºç®—æ³•ï¼ˆFIFOï¼ŒFirst-In First-Outï¼‰

- æ€è·¯ï¼šé€‰æ‹©åœ¨å†…å­˜é©»ç•™æ—¶é—´æœ€é•¿çš„é¡µé¢è¿›è¡Œç½®æ¢
- å®ç°
  - ç»´æŠ¤ä¸€ä¸ªè®°å½•æ‰€æœ‰ä½äºå†…å­˜ä¸­çš„é€»è¾‘é¡µé¢é“¾è¡¨
  - é“¾è¡¨å…ƒç´ æŒ‰é©»ç•™å†…å­˜çš„æ—¶é—´æ’åºï¼Œé“¾é¦–æœ€é•¿ï¼Œé“¾å°¾æœ€çŸ­
  - å‡ºç°ç¼ºé¡µæ—¶ï¼Œé€‰æ‹©é“¾é¦–é¡µé¢è¿›è¡Œç½®æ¢ï¼Œæ–°é¡µé¢åŠ åˆ°é“¾å°¾
- ç‰¹å¾
  - å®ç°ç®€å•
  - æ€§èƒ½è¾ƒå·®ï¼Œè°ƒå‡ºçš„é¡µé¢å¯èƒ½æ˜¯ç»å¸¸è®¿é—®çš„
  - è¿›ç¨‹åˆ†é…ç‰©ç†é¡µé¢æ•°å¢åŠ æ—¶ï¼Œç¼ºé¡µå¹¶ä¸ä¸€å®šå‡å°‘ï¼ˆBelady ç°è±¡ï¼‰
  - å¾ˆå°‘å•ç‹¬ä½¿ç”¨

### æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•ï¼ˆLRUï¼ŒLeast Recently Usedï¼‰

- æ€è·¯ï¼šé€‰æ‹©æœ€é•¿æ—¶é—´æ²¡æœ‰è¢«å¼•ç”¨çš„é¡µé¢è¿›è¡Œç½®æ¢ï¼Œå¦‚æŸäº›é¡µé¢é•¿æ—¶é—´æœªè¢«è®¿é—®ï¼Œåˆ™å®ƒä»¬åœ¨å°†æ¥è¿˜å¯èƒ½ä¼šé•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®
- å®ç°
  - ç¼ºé¡µæ—¶ï¼Œè®¡ç®—å†…å­˜ä¸­æ¯ä¸ªé€»è¾‘é¡µé¢çš„ä¸Šä¸€æ¬¡è®¿é—®æ—¶é—´
  - é€‰æ‹©ä¸Šä¸€æ¬¡ä½¿ç”¨åˆ°å½“å‰æ—¶é—´æœ€é•¿çš„é¡µé¢
- ç‰¹å¾ï¼šæœ€ä¼˜ç½®æ¢ç®—æ³•çš„ä¸€ç§è¿‘ä¼¼ï¼Œå¼€é”€è¾ƒå¤§
- å¯èƒ½å®ç°ï¼š
  - 1) é¡µé¢é“¾è¡¨ï¼šç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªæŒ‰æœ€è¿‘ä¸€æ¬¡è®¿é—®æ—¶é—´æ’åºçš„é¡µé¢é“¾è¡¨ï¼Œé“¾è¡¨é¦–èŠ‚ç‚¹æ˜¯æœ€è¿‘åˆšåˆšä½¿ç”¨è¿‡çš„é¡µé¢ï¼Œé“¾è¡¨å°¾èŠ‚ç‚¹æ˜¯æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢
    - è®¿é—®å†…å­˜æ—¶ï¼Œæ‰¾åˆ°ç›¸åº”é¡µé¢ï¼Œå¹¶æŠŠå®ƒç§»åˆ°é“¾è¡¨é¦–éƒ¨
    - ç¼ºé¡µæ—¶ï¼Œç½®æ¢é“¾è¡¨å°¾èŠ‚ç‚¹çš„é¡µé¢
  - 2) æ´»åŠ¨é¡µé¢æ ˆ
    - è®¿é—®é¡µé¢æ—¶ï¼Œå°†æ­¤é¡µå·å‹å…¥æ ˆé¡¶ï¼Œå¹¶æ ˆå†…ç›¸åŒçš„é¡µå·æŠ½å‡º
    - ç¼ºé¡µæ—¶ï¼Œç½®æ¢æ ˆåº•çš„é¡µé¢

### æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆClockï¼‰

- æ€è·¯
  - ä»…å¯¹é¡µé¢çš„è®¿é—®æƒ…å†µè¿›è¡Œå¤§è‡´æ’åº
- æ•°æ®ç»“æ„
  - åœ¨é¡µè¡¨é¡¹ä¸­å¢åŠ è®¿é—®ä½ï¼Œæè¿°é¡µé¢åœ¨è¿‡å»ä¸€æ®µæ—¶é—´å†…çš„è®¿é—®æƒ…å†µ
  - å„é¡µé¢ç»„ç»‡æˆç¯å½¢é“¾è¡¨
  - æŒ‡é’ˆæŒ‡å‘æœ€å…ˆè°ƒå…¥çš„é¡µé¢
- ç®—æ³•
  - è®¿é—®é¡µé¢æ—¶ï¼Œåœ¨é¡µè¡¨é¡¹è®°å½•é¡µé¢çš„è®¿é—®æƒ…å†µ
  - ç¼ºé¡µæ—¶ï¼Œä»æŒ‡é’ˆå¤„å¼€å§‹é¡ºåºæŸ¥æ‰¾æœªè¢«è®¿é—®çš„é¡µé¢è¿›è¡Œç½®æ¢ï¼ˆFIFOï¼‰
- ç‰¹å¾
  - æ—¶é’Ÿç®—æ³•æ˜¯ LRU å’Œ FIFO çš„æŠ˜ä¸­ï¼ˆå¯¹è¿‡å»çš„è®¿é—®æƒ…å†µæœ‰è€ƒè™‘ï¼Œä½†æ˜¯ç½®æ¢çš„å°±æ˜¯è¿‡å»ä¸€æ®µæ—¶é—´æ²¡æœ‰è®¿é—®çš„é¡µé¢ï¼Œä¸æ˜¯å»æ‰¾æœ€ä¹…æœªè®¿é—®çš„é¡µé¢ï¼‰
- å®ç°ï¼š
  - é¡µé¢è£…å…¥å†…å­˜æ—¶ï¼Œè®¿é—®ä½åˆå§‹åŒ–ä¸º 0ï¼›è®¿é—®é¡µé¢ï¼ˆè¯»/å†™ï¼‰æ—¶ï¼Œè®¿é—®ä½è®¾ç½®ä¸º 1
  - ç¼ºé¡µæ—¶ï¼Œä»æŒ‡é’ˆå½“å‰ä½ç½®é¡ºåºæ£€æŸ¥ç¯å½¢é“¾è¡¨ï¼Œè‹¥è®¿é—®ä½ä¸º 0ï¼Œåˆ™ç½®æ¢è¯¥é¡µï¼›è‹¥è®¿é—®ä½ä¸º 1ï¼Œåˆ™å°†è®¿é—®ä½è®¾ç½®ä¸º 0ï¼ˆè¡¨ç¤ºä»å½“å‰æ—¶é—´ç‚¹é‡æ–°å¼€å§‹è®°å½•æ˜¯å¦è®¿é—®ï¼‰ï¼Œå¹¶æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œç›´åˆ°æ‰¾åˆ°å¯ç½®æ¢çš„é¡µé¢
- æ”¹è¿›çš„æ—¶é’Ÿç®—æ³•
  - æ€è·¯æ˜¯å‡å°‘ä¿®æ”¹é¡µçš„ç¼ºé¡µå¤„ç†å¼€é”€ï¼ˆå¦‚æœæœ‰ä¿®æ”¹ï¼Œåˆ™è·³è¿‡è¿™ä¸€é¡µä¸åšç½®æ¢ï¼Œç³»ç»Ÿå®šæœŸå°†ä¿®æ”¹è¿‡çš„é¡µå†™åˆ°å¤–å­˜ä¸­å»ï¼‰ã€‚
  - åœ¨é¡µè¡¨é¡¹ä¸­å¢åŠ ä¿®æ”¹ä½ï¼Œå¹¶åœ¨è®¿é—®æ—¶è¿›è¡Œç›¸åº”ä¿®æ”¹ï¼ˆå¦‚æœæ˜¯è¯»æ“ä½œï¼Œä»…ä¿®æ”¹è®¿é—®ä½ä¸º1ï¼Œä¿®æ”¹ä½ä¸º 0ï¼›å¦‚æœæ˜¯å†™æ“ä½œï¼Œä¿®æ”¹ä½å’Œè®¿é—®ä½åŒæ—¶ç½® 1ï¼‰
  - ç¼ºé¡µæ—¶ï¼Œä¿®æ”¹é¡µè¡¨é¡¹æ ‡å¿—ä½ï¼Œä»¥è·³è¿‡æœ‰ä¿®æ”¹çš„é¡µé¢

![dirty-reference-bit](images/dirty-reference-bit.png)

### æœ€ä¸å¸¸ç”¨ç®—æ³•ï¼ˆLFUï¼ŒLeast Frequently Usedï¼‰

- æ€è·¯ï¼šç¼ºé¡µæ—¶ï¼Œç½®æ¢è®¿é—®æ¬¡æ•°æœ€å°‘çš„é¡µé¢
- å®ç°
  - æ¯ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ªè®¿é—®è®¡æ•°
  - è®¿é—®é¡µé¢æ—¶ï¼Œè®¿é—®è®¡æ•°åŠ  1
  - ç¼ºé¡µæ—¶ï¼Œç½®æ¢è®¡æ•°æœ€å°çš„é¡µé¢
- ç‰¹å¾
  - ç®—æ³•å¼€é”€å¤§
  - å¼€å§‹æ—¶é¢‘ç¹ä½¿ç”¨ï¼Œä½†ä»¥åä¸ä½¿ç”¨çš„é¡µé¢å¾ˆéš¾ç½®æ¢ï¼ˆè§£å†³åŠæ³•ï¼šè®¡æ•°å®šæœŸåšè¡°å‡å³ç§»ï¼‰
- LRU å’Œ LFU çš„åŒºåˆ«
  - LRU å…³æ³¨å¤šä¹…æœªè®¿é—®ï¼Œæ—¶é—´è¶ŠçŸ­è¶Šå¥½
  - LFU å…³æ³¨è®¿é—®æ¬¡æ•°ï¼Œæ¬¡æ•°è¶Šå¤šè¶Šå¥½

### Belady ç°è±¡

- ç°è±¡ï¼šé‡‡ç”¨ FIFO ç­‰ç®—æ³•æ—¶ï¼Œå¯èƒ½å‡ºç°åˆ†é…çš„ç‰©ç†é¡µé¢æ•°å¢åŠ ï¼Œç¼ºé¡µæ¬¡æ•°åè€Œå‡é«˜çš„å¼‚å¸¸ç°è±¡
- åŸå› ï¼šFIFO ç®—æ³•çš„ç½®æ¢ç‰¹å¾ä¸è¿›ç¨‹è®¿é—®å†…å­˜çš„åŠ¨æ€ç‰¹å¾ç›¸çŸ›ç›¾ï¼Œè¢«ç®—æ³•ç½®æ¢å‡ºå»çš„é¡µé¢å¹¶ä¸ä¸€å®šæ˜¯è¿›ç¨‹è¿‘æœŸä¸ä¼šè®¿é—®çš„
- æ€è€ƒï¼šå“ªäº›ç½®æ¢ç®—æ³•æ²¡æœ‰ Belady ç°è±¡ï¼ŸLRU æ²¡æœ‰ Belady ç°è±¡
- æ—¶é’Ÿ/æ”¹è¿›çš„æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•æ˜¯å¦æœ‰ Belady ç°è±¡ï¼Ÿ
- ä¸ºä»€ä¹ˆ LRU é¡µé¢ç½®æ¢ç®—æ³•æ²¡æœ‰ Belady ç°è±¡ï¼Ÿã€æ€è€ƒï¼Ÿã€‘

### æ¯”è¾ƒ

- LRU ç®—æ³•å’Œ FIFO æœ¬è´¨ä¸Šéƒ½æ˜¯å…ˆè¿›å…ˆå‡ºçš„æ€æƒ³
  - LRU æ ¹æ®é¡µé¢çš„æœ€è¿‘è®¿é—®æ—¶é—´æ’åº
  - LRU åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦åŠ¨æ€åœ°è°ƒæ•´é¡ºåº
  - FIFO ä¾æ®é¡µé¢è¿›å…¥å†…å­˜çš„æ—¶é—´æ’åº
  - FIFO çš„é¡µé¢è¿›å…¥æ—¶é—´æ˜¯å›ºå®šä¸å˜çš„
- LRU å¯é€€åŒ–ä¸º FIFO
  - å¦‚é¡µé¢è¿›å…¥å†…å­˜åå°±æ²¡æœ‰è¢«è®¿é—®ï¼Œæœ€è¿‘è®¿é—®æ—¶é—´å’Œè¿›å…¥å†…å­˜æ—¶é—´æ˜¯ç›¸åŒçš„ï¼ˆè§†é¢‘æµï¼‰
- LRU ç®—æ³•æ€§èƒ½å¥½ï¼Œä½†ç³»ç»Ÿå¼€é”€è¾ƒå¤§
- FIFO ç®—æ³•ç³»ç»Ÿå¼€é”€è¾ƒå°ï¼Œä¼šå‘ç”Ÿ Belady ç°è±¡
- Clock ç®—æ³•æ˜¯ LRU å’Œ FIFO çš„æŠ˜ä¸­
  - è®¿é—®é¡µé¢æ—¶ï¼Œä¸åŠ¨æ€è°ƒæ•´é¡µé¢åœ¨é“¾è¡¨ä¸­çš„é¡ºåºï¼Œä»…åšæ ‡è®°
  - ç¼ºé¡µæ—¶ï¼Œå†æŠŠå®ƒç§»åŠ¨åˆ°é“¾è¡¨æœ«å°¾
- å¯¹äºæœªè®¿é—®è¿‡çš„é¡µé¢ï¼ŒClock å’Œ LRU ç®—æ³•çš„è¡¨ç°ä¸€æ ·å¥½
- å¯¹äºè¢«è®¿é—®è¿‡çš„é¡µé¢ï¼ŒClock ç®—æ³•ä¸èƒ½è®°å½•å‡†ç¡®è®¿é—®é¡ºåºï¼Œè€Œ LRU ç®—æ³•å¯ä»¥

## å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•

å±€éƒ¨é¡µé¢ç½®æ¢ç®—æ³•æ²¡æœ‰è€ƒè™‘è¿›ç¨‹è®¿å­˜çš„å·®å¼‚æ€§ï¼ˆå› ä¸ºåˆ†é…ç»™è¿›ç¨‹çš„é¡µé¢æ•°ç¡®å®šäº†ï¼‰

å…¨å±€ç½®æ¢ç®—æ³•ä¸ºè¿›ç¨‹åˆ†é…å¯å˜æ•°ç›®çš„ç‰©ç†é¡µé¢ã€‚é‚£åˆ†ç»™å„ä¸ªè¿›ç¨‹å¤šå°‘ç‰©ç†é¡µé¢å‘¢ï¼Ÿè¿›ç¨‹åœ¨ä¸åŒé˜¶æ®µçš„å†…å­˜éœ€æ±‚æ˜¯å˜åŒ–çš„ï¼Œè¿™æ ·å†ä¸åŒçš„é˜¶æ®µåˆ†é…ç»™è¿›ç¨‹çš„å†…å­˜ä¹Ÿéœ€è¦æœ‰æ‰€å˜åŒ–ã€‚å…¨å±€ç½®æ¢ç®—æ³•éœ€è¦ç¡®å®šåˆ†é…ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°

### CPU åˆ©ç”¨ç‡ä¸å¹¶å‘è¿›ç¨‹æ•°çš„å…³ç³»

CPU åˆ©ç”¨ç‡ä¸å¹¶å‘è¿›ç¨‹æ•°å­˜åœ¨ç›¸äº’ä¿ƒè¿›å’Œåˆ¶çº¦çš„å…³ç³»

- è¿›ç¨‹æ•°å°‘æ—¶ï¼Œæé«˜å¹¶å‘è¿›ç¨‹æ•°ï¼Œå¯æé«˜ CPU åˆ©ç”¨ç‡
- å¹¶å‘è¿›ç¨‹å¯¼è‡´å†…å­˜è®¿é—®å¢åŠ 
- å¹¶å‘è¿›ç¨‹çš„å†…å­˜è®¿é—®ä¼šé™ä½è®¿å­˜çš„å±€éƒ¨æ€§ç‰¹å¾
- å±€éƒ¨æ€§ç‰¹å¾çš„ä¸‹è½½ä¼šå¯¼è‡´ç¼ºé¡µç‡ä¸Šå‡å’Œ CPU åˆ©ç”¨ç‡ä¸‹é™

![prognum-cpu-utility](images/prognum-cpu-utility.png)

### å·¥ä½œé›†ç½®æ¢ç®—æ³•

ä¸€ä¸ªè¿›ç¨‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„é€»è¾‘é¡µé¢é›†åˆï¼Œå¯è¡¨ç¤ºä¸ºäºŒå…ƒå‡½æ•° W(t, `$\Delta$`)

- t æ˜¯å½“å‰çš„æ‰§è¡Œæ—¶åˆ»
- `$\Delta$` ç§°ä¸ºå·¥ä½œé›†çª—å£ï¼ˆworking-set windowï¼‰ï¼Œå³ä¸€ä¸ªå®šé•¿çš„é¡µé¢è®¿é—®æ—¶é—´çª—å£
- W(t, `$\Delta$`) æ˜¯æŒ‡åœ¨å½“å‰æ—¶åˆ» t å‰çš„ `$\Delta$` æ—¶é—´çª—å£ä¸­çš„æ‰€æœ‰è®¿é—®é¡µé¢æ‰€ç»„æˆçš„é›†åˆ
- |W(t, `$\Delta$`)| æŒ‡å·¥ä½œé›†çš„å¤§å°ï¼Œå³é¡µé¢æ•°ç›®

ä¸€ä¸ªè¿›ç¨‹çš„å·¥ä½œé›†çš„å¤§å°éšç€è¿›ç¨‹æ‰§è¡Œæ—¶é—´çš„å˜åŒ–è€Œå˜åŒ–ï¼š

![working-set-size](images/working-set-size.png)

1. è¿›ç¨‹å¼€å§‹æ‰§è¡Œåï¼Œéšç€è®¿é—®æ–°é¡µé¢é€æ­¥å»ºç«‹è¾ƒç¨³å®šçš„å·¥ä½œé›†
2. å½“å†…å­˜è®¿é—®çš„å±€éƒ¨æ€§åŒºåŸŸçš„ä½ç½®å¤§è‡´ç¨³å®šæ—¶ï¼Œå·¥ä½œé›†å¤§å°ä¹Ÿå¤§è‡´ç¨³å®š
3. å±€éƒ¨æ€§åŒºåŸŸçš„ä½ç½®æ”¹å˜æ—¶ï¼Œå·¥ä½œé›†å¿«é€Ÿæ‰©å¼ å’Œæ”¶ç¼©è¿‡æ¸¡åˆ°ä¸‹ä¸€ä¸ªç¨³å®šå€¼

**å¸¸é©»é›†ï¼š**

åœ¨å½“å‰æ—¶åˆ»ï¼Œè¿›ç¨‹å®é™…é©»ç•™åœ¨å†…å­˜å½“ä¸­çš„é¡µé¢é›†åˆ

**å·¥ä½œé›†ä¸å¸¸é©»é›†çš„å…³ç³»ï¼š**

- å·¥ä½œé›†æ˜¯è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„å›ºæœ‰æ€§è´¨
- å¸¸é©»é›†å–å†³äºç³»ç»Ÿåˆ†é…ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°ç›®å’Œé¡µé¢ç½®æ¢ç®—æ³•

**ç¼ºé¡µç‡å’Œå¸¸é©»é›†çš„å…³ç³»ï¼š**

- å¦‚æœå¸¸é©»é›†åŒ…å«äº†å·¥ä½œé›†ï¼Œç¼ºé¡µè¾ƒå°‘
- å·¥ä½œé›†å‘ç”Ÿå‰§çƒˆå˜åŠ¨ï¼ˆè¿‡æ¸¡ï¼‰æ—¶ï¼Œç¼ºé¡µè¾ƒå¤š
- è¿›ç¨‹å¸¸é©»é›†å¤§å°è¾¾åˆ°ä¸€å®šæ•°ç›®åï¼Œç¼ºé¡µç‡ä¹Ÿä¸ä¼šæ˜æ˜¾ä¸‹é™

**å·¥ä½œé›†ç½®æ¢ç®—æ³•ï¼š**

- æ€è·¯ï¼šæ¢å‡ºä¸åœ¨å·¥ä½œé›†çš„é¡µé¢
- çª—å£å¤§å° ğ½ï¼Œå½“å‰æ—¶åˆ»å‰ ğ½ å„å†…å­˜è®¿é—®çš„é¡µå¼•ç”¨æ˜¯å·¥ä½œé›†ï¼Œè¢«ç§°ä¸ºçª—å£å¤§å°
- å®ç°æ–¹æ³•ï¼ˆå¼€é”€å¤§ï¼‰
  - è®¿å­˜é“¾è¡¨ï¼šé“¾è¡¨ç”¨äºç»´æŠ¤çª—å£å†…çš„è®¿å­˜é¡µé¢
  - è®¿å­˜æ—¶ï¼Œæ¢å‡ºä¸åœ¨å·¥ä½œé›†çš„é¡µé¢ï¼›æ›´æ–°è®¿å­˜é“¾è¡¨
  - ç¼ºé¡µæ—¶ï¼Œæ¢å…¥é¡µé¢ï¼›æ›´æ–°è®¿å­˜é“¾è¡¨

### ç¼ºé¡µç‡ç½®æ¢ç®—æ³•

æ ¹æ®ç¼ºé¡µä¹‹é—´çš„é—´éš”æ¥è°ƒæ•´å°†å“ªäº›é¡µé¢æ”¾åˆ°å†…å­˜ä¸­ï¼Œå“ªäº›é¡µé¢éœ€è¦è¢«ç½®æ¢å‡ºå»

**ç¼ºé¡µç‡ï¼ˆpage fault rateï¼‰ï¼š**

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç†è§£çš„ç¼ºé¡µç‡æ˜¯ç¼ºé¡µçš„æ¬¡æ•°å’Œè®¿å­˜æ¬¡æ•°ä¹‹é—´çš„æ¯”å€¼ï¼ˆç¼ºé¡µå¹³å‡æ—¶é—´é—´éš”çš„å€’æ•°ï¼‰ã€‚å½±å“ç¼ºé¡µç‡çš„å› ç´ æœ‰ï¼š

1. é¡µé¢ç½®æ¢ç®—æ³•
2. åˆ†é…ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°
3. é¡µé¢å¤§å°
4. ç¨‹åºçš„ç¼–å†™æ–¹æ³•

**ç¼ºé¡µç‡ç½®æ¢ç®—æ³•ï¼ˆPFFï¼ŒPage Fault Frequencyï¼‰ï¼š**

é€šè¿‡è°ƒèŠ‚å¸¸é©»é›†å¤§å°ï¼Œä½¿å¾—æ¯ä¸ªè¿›ç¨‹çš„ç¼ºé¡µç‡ä¿æŒåœ¨ä¸€ä¸ªåˆç†çš„èŒƒå›´å†…

![page-fault-rate](images/page-fault-rate.png)

1. è‹¥è¿›ç¨‹ç¼ºé¡µç‡è¿‡é«˜ï¼Œåˆ™å¢åŠ å¸¸é©»é›†ä»¥åˆ†é…æ›´å¤šçš„ç‰©ç†é¡µé¢
2. è‹¥è¿›ç¨‹ç¼ºé¡µç‡è¿‡ä½ï¼Œåˆ™å‡å°‘å¸¸é©»é›†ä»¥è¾ƒå°‘å®ƒçš„ç‰©ç†é¡µé¢æ•°

**å®ç°ï¼š**

- è®¿å­˜æ—¶ï¼Œè®¾ç½®å¼•ç”¨ä½æ ‡å¿—
- ç¼ºé¡µæ—¶ï¼Œè®¡ç®—ä»ä¸Šæ¬¡ç¼ºé¡µæ—¶é—´ `$t_{last}$` åˆ°ç°åœ¨ `$t_{current}$` çš„æ—¶é—´é—´éš”
- å¦‚æœ `$t_{current} - t_{last} > T$`ï¼Œåˆ™ç½®æ¢æ‰€æœ‰åœ¨ `$[t_{current}, t_{last}]$` æ—¶é—´å†…æ²¡æœ‰è¢«å¼•ç”¨çš„é¡µ
- å¦‚æœ  `$t_{current} - t_{last} <= T$`ï¼Œåˆ™å¢åŠ ç¼ºå¤±é¡µåˆ°å¸¸é©»é›†ä¸­
- åœ¨å·¥ä½œé›†ç®—æ³•ä¸­ï¼Œé€‰æ‹©éœ€è¦ç½®æ¢çš„é¡µé¢æ˜¯åœ¨è®¿é—®æ—¶ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼›åœ¨ç¼ºé¡µç‡ç®—æ³•ä¸­ï¼Œæ˜¯åœ¨äº§ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œä¼šå»è€ƒå¯Ÿç¼ºé¡µç‡æ˜¯è¿‡ä½è¿˜æ˜¯è¿‡é«˜ï¼Œå°†ç½®æ¢é¡µé¢çš„æ“ä½œæ”¾åˆ°ç¼ºé¡µæ—¶æ¥è¿›è¡Œå¤„ç†

### æŠ–åŠ¨ï¼ˆthrashingï¼‰

åœ¨ç³»ç»Ÿä¸­æœ‰å¤šå°‘ä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹åœ¨ä¸€èµ·æ‰§è¡Œï¼Œå¯¹äºç³»ç»Ÿæ¥è¯´æ˜¯æ•ˆç‡æœ€é«˜çš„

æŠ–åŠ¨æ˜¯ç”±äºåœ¨ç³»ç»Ÿä¸­æ‰§è¡Œçš„è¿›ç¨‹æ•°ç›®è¿‡å¤šï¼Œæ¯ä¸ªè¿›ç¨‹åˆ†é…åˆ°çš„ç‰©ç†é¡µé¢æ•°å¤ªå°‘ï¼Œå‡å°‘åˆ°ä¸€å®šç¨‹åº¦ï¼Œä¸èƒ½åŒ…å«å·¥ä½œé›†ï¼Œå› æ­¤é€ æˆå¤§é‡ç¼ºé¡µï¼Œé¢‘ç¹ç½®æ¢ï¼Œè¿›ç¨‹è¿è¡Œé€Ÿåº¦å˜æ…¢ã€‚å³éšç€é©»ç•™å†…å­˜çš„è¿›ç¨‹æ•°ç›®å¢åŠ ï¼Œåˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°ä¸æ–­å‡å°ï¼Œç¼ºé¡µç‡ä¸æ–­ä¸Šå‡ã€‚

æ“ä½œç³»ç»Ÿéœ€è¦åœ¨å¹¶å‘æ°´å¹³å’Œç¼ºé¡µç‡ä¹‹é—´è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œé€‰æ‹©ä¸€ä¸ªé€‚å½“çš„è¿›ç¨‹æ•°ç›®ï¼ˆè°ƒèŠ‚å¹¶å‘è¿›ç¨‹æ•°ï¼‰å’Œè¿›ç¨‹éœ€è¦çš„ç‰©ç†é¡µé¢æ•°ç›®ï¼ˆç½®æ¢ç®—æ³•ï¼‰

### è´Ÿè½½æ§åˆ¶

é€šè¿‡è°ƒèŠ‚å¹¶å‘è¿›ç¨‹æ•°ï¼ˆMPLï¼ŒMulti-Programming Levelï¼‰æ¥è¿›è¡Œç³»ç»Ÿè´Ÿè½½æ§åˆ¶

- `$\Sigma WS_{i}$` = å†…å­˜å¤§å°
- å¹³å‡ç¼ºé¡µé—´éš”æ—¶é—´ï¼ˆMTBFï¼ŒMean Time Between Page Faultsï¼‰
- ç¼ºé¡µå¼‚å¸¸å¤„ç†æ—¶é—´ï¼ˆPFSTï¼ŒPage Fault Service Timeï¼‰

![load-balance](images/load-balance.png)

ç›®æ ‡ï¼šå°±æ•´ä¸ªç³»ç»Ÿå¤„äºå‡è¡¡çš„ç¹å¿™çŠ¶æ€

## ç‰ˆæƒå£°æ˜

æœ¬ä½œå“é‡‡ç”¨[çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…è®¸å¯åè®®](http://creativecommons.org/licenses/by/4.0/)è¿›è¡Œè®¸å¯ï¼Œè½¬è½½æ—¶è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ã€‚
